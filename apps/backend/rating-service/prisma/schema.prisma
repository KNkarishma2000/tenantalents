generator client {
  provider = "prisma-client-js"
}

// === DATABASE SOURCE ===
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

//
// ENUMS
//

/// Entity that is being rated: either a product or a seller
enum RatingTargetType {
  PRODUCT     // Buyer rating a product
  SELLER      // Buyer rating a seller
}

//
// MODELS
//

/// Stores individual reviews left by buyers for products or sellers
model Rating {
  id           String           @id @default(uuid())            // Unique rating ID
  userId       String                                            // FK to User (buyer)
  targetId     String                                            // FK to Product or Seller depending on type
  targetType   RatingTargetType                                  // Indicates what entity is being rated
  stars        Int                                               // Star rating (1â€“5)
  comment      String?                                           // Optional review comment
  createdAt    DateTime         @default(now())                 // Timestamp when rating was submitted

  @@index([userId])
  @@index([targetId])
  @@index([targetType])
  @@unique([userId, targetId, targetType])                      // Prevent duplicate ratings per user per target
}
